<!-- <!DOCTYPE html>
<html>
  <head>
    <title>Create Recipe</title>
  </head>
  <body>
    <h1>Create a new recipe</h1>
    <form action="/createRecipe" method="POST">
      <label for="title">Recipe Title:</label><br>
      <input type="text" id="title" name="title" required><br>
      <label for="ingredients">Ingredients (separate each ingredient with a comma):</label><br>
      <textarea id="ingredients" name="ingredients" required></textarea><br>
      <label for="instructions">Instructions:</label><br>
      <textarea id="instructions" name="instructions" required></textarea><br>
      <input type="hidden" id="user" name="user" value="65748e945441b65b7455a7a0">
      <input type="submit" value="Create Recipe">
    </form>
  </body>
</html> -->

<!DOCTYPE html>
<html>
<head>
    <title>Create Recipe</title>
    <script>
        let ingredientId = 0;

        function addIngredientField() {
            const ingredientsDiv = document.getElementById('ingredients');
            const newDiv = document.createElement('div');
            newDiv.id = `ingredient-${ingredientId}`;

            const newInput = document.createElement('input');
            newInput.type = 'text';
            newInput.name = 'ingredient';

            const newButton = document.createElement('button');
            newButton.type = "button";
            newButton.textContent = "Remove ingredient";
            newButton.onclick = function () {
                document.getElementById(newDiv.id).remove();
            };

            newDiv.appendChild(newInput);
            newDiv.appendChild(newButton);
            ingredientsDiv.appendChild(newDiv);
            ingredientId++;
        }

        function submitRecipe() {
            const title = document.getElementById('title').value;
            const instructions = document.getElementById('instructions').value;
            const user = document.getElementById('user').value;
            const ingredients = Array.from(document.getElementsByName('ingredient')).map(input => input.value);

            const recipe = {
                title,
                instructions,
                user,
                ingredients
            };

            fetch('/createRecipe', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(recipe)
            })
            .then(response => response.text())
            .then(text => console.log(text))
            .catch(error => console.error(error));
        }

        window.onload = function() {
            document.getElementById('recipeForm').addEventListener('submit', function(event) {
                event.preventDefault();
                submitRecipe();
            });
        }
    </script>
</head>
<body>
    <h1>Create a new recipe</h1>
    <form id="recipeForm">
        <label for="title">Recipe Title:</label><br>
        <input type="text" id="title" required><br>
        <label>Ingredients:</label><br>
        <div id="ingredients">
            <div id="ingredient-0">
                <input type="text" name="ingredient" required>
                <button type="button" onclick="this.parentElement.remove()">Remove ingredient</button><br>
            </div>
        </div>
        <button type="button" onclick="addIngredientField()">Add Ingredient</button><br>
        <label for="instructions">Instructions:</label><br>
        <textarea id="instructions" required></textarea><br>
        <input type="hidden" id="user" value="65748e945441b65b7455a7a0">
        <input type="submit" value="Create Recipe">
    </form>
</body>
</html>